library(boot)
set.seed(1)
Y=rnorm(100)
X=rnorm(100)
Y=X-2*X^2+rnorm(100)
plot(X,Y)
set.seed(1)
z <- glm(Y ~ X)
cv.glm(Data, z)$delta[1]
x
set.seed(1)
Data <- data.frame(X, Y)
set.seed(1)
Data <- data.frame(X,Y)
z <- glm(Y ~ X)
cv.glm(Data, z)$delta[1]
z <- glm(Y ~ poly(X,2))
cv.glm(Data, z)$delta[1]
z <- glm(Y ~ poly(X,3))
cv.glm(Data, z)$delta[1]
z <- glm(Y ~ poly(X,4))
cv.glm(Data, z)$delta[1]
set.seed(5)
z <- glm(Y ~ X)
cv.glm(Data, z)$delta[1]
z <- glm(Y ~ poly(X,2))
cv.glm(Data, z)$delta[1]
z <- glm(Y ~ poly(X,3))
cv.glm(Data, z)$delta[1]
z <- glm(Y ~ poly(X,4))
cv.glm(Data, z)$delta[1]
summary(X,Y)
summary(glm(Y ~ X))
x1 <- c(3, 2, 4, 1, 2, 4, 4)
x2 <- c(4, 2, 4, 4, 1, 3, 1)
y <- c("Red", "Red", "Red", "Red", "Blue", "Blue", "Blue")
y <- as.factor(y)
data <- data.frame(x1, x2, y)
plot(x1, x2, col = c("blue", "red")[y], pch = 20)
x1 <- c(3, 2, 4, 1, 2, 4, 4)
x2 <- c(4, 2, 4, 4, 1, 3, 1)
y <- c("Red", "Red", "Red", "Red", "Blue", "Blue", "Blue")
data <- data.frame(x1, x2, y)
plot(x1, x2, col = c("blue", "red")[y], pch = 20)
x1 <- c(3, 2, 4, 1, 2, 4, 4)
x2 <- c(4, 2, 4, 4, 1, 3, 1)
y <- c("Red", "Red", "Red", "Red", "Blue", "Blue", "Blue")
y <- as.factor(y)
data <- data.frame(x1, x2, y)
plot(x1, x2, col = c("blue", "red")[y], pch = 20)
x1 <- c(3, 2, 4, 1, 2, 4, 4)
x2 <- c(4, 2, 4, 4, 1, 3, 1)
y <- c("Red", "Red", "Red", "Red", "Blue", "Blue", "Blue")
y <- as.factor(y)
data <- data.frame(x1, x2, y)
plot(x1, x2, col = c("blue", "red")[y], pch = 10)
x1 <- c(3, 2, 4, 1, 2, 4, 4)
x2 <- c(4, 2, 4, 4, 1, 3, 1)
y <- c("Red", "Red", "Red", "Red", "Blue", "Blue", "Blue")
y <- as.factor(y)
data <- data.frame(x1, x2, y)
plot(x1, x2, col = c("blue", "red")[y], pch = 20)
x1 <- c(3, 2, 4, 1, 2, 4, 4)
x2 <- c(4, 2, 4, 4, 1, 3, 1)
y <- c("Red", "Red", "Red", "Red", "Blue", "Blue", "Blue")
y <- as.factor(y)
data <- data.frame(x1, x2, y)
plot(x1, x2, col = c("blue", "red")[y])
x1 <- c(3, 2, 4, 1, 2, 4, 4)
x2 <- c(4, 2, 4, 4, 1, 3, 1)
y <- c("Red", "Red", "Red", "Red", "Blue", "Blue", "Blue")
y <- as.factor(y)
data <- data.frame(x1, x2, y)
plot(x1, x2, col = c("red", "blue")[y])
plot(x1, x2, col = colors, xlim = c(0, 5), ylim = c(0, 5))
abline(-0.5, 1)
plot(x1, x2, col = c("red", "blue")[y], pch = 20)
abline(-0.5, 1, col = "green")
abline(-0.5, 1)
plot(x1, x2, col = c("red", "blue")[y])
abline(-0.5, 1)
plot(x1, x2, xlim = c(0, 5), ylim = c(0, 5))
abline(-0.5, 1)
abline(-1, 1, lty = 2)
abline(0, 1, lty = 2)
plot(x1, x2, col = colors, xlim = c(0, 5), ylim = c(0, 5))
abline(-0.5, 1)
abline(-1, 1, lty = 2)
abline(0, 1, lty = 2)
plot(x1, x2, col = colors, xlim = c(0, 5), ylim = c(0, 5))
abline(-0.5, 1)
abline(-1, 1, lty = 2)
abline(0, 1, lty = 2)
plot(x1, x2, col = c("blue", "red")[y], pch = 20)
abline(-0.5, 1, col = "green")
abline(-1, 1, col = "black", lty = 2)
abline(0, 1, col = "black", lty = 2)
plot(x1, x2, col = c("red", "blue")[y])
abline(-0.5, 1, col = "green")
abline(-1, 1, col = "black", lty = 2)
abline(0, 1, col = "black", lty = 2)
plot(x1, x2, col = c("red", "blue")[y])
abline(-0.5, 1, col = "yellow")
abline(-1, 1, col = "black", lty = 2)
abline(0, 1, col = "black", lty = 2)
plot(x1, x2, col = c("red", "blue")[y])
abline(-0.5, 1)
abline(-1, 1, col = "black", lty = 2)
abline(0, 1, col = "black", lty = 2)
x1 <- c(3, 2, 4, 1, 2, 4, 4)
x2 <- c(4, 2, 4, 4, 1, 3, 1)
y <- c("Red", "Red", "Red", "Red", "Blue", "Blue", "Blue")
y <- as.factor(y)
data <- data.frame(x1, x2, y)
plot(x1, x2, col = c("blue", "red")[y], pch = 20)
plot(x1, x2, col = c("blue", "red")[y])
plot(x1, x2, col = c("blue", "red")[y], pch = 20)
abline(-0.5, 1, col = "green")
plot(x1, x2, col = c("blue", "red")[y], pch = 20)
abline(-0.5, 1)
plot(x1, x2, col = c("blue", "red")[y], pch = 20)
abline(-0.5, 1)
abline(-1, 1, col = "black", lty = 2)
abline(0, 1, col = "black", lty = 2)
plot(x1, x2, col = c("blue", "red")[y], pch = 20)
abline(-0.5, 1, col = "green")
abline(-0.6, 1.1, col = "orange")
plot(x1, x2, col = c("blue", "red")[y], pch = 20)
abline(-0.5, 1, col = "green")
abline(-0.6, 2, col = "orange")
plot(x1, x2, col = c("blue", "red")[y], pch = 20)
abline(-0.5, 1, col = "green")
abline(-0.6, 0.9, col = "orange")
plot(x1, x2, col = c("blue", "red")[y], pch = 20)
abline(-0.5, 1, col = "green")
abline(-0.6, 1.1, col = "orange")
plot(x1, x2, col = c("blue", "red")[y], pch = 20)
abline(-0.5, 1, col = "green")
abline(-0.6, 0.9, col = "orange")
plot(x1, x2, col = c("blue", "red")[y], pch = 20)
abline(-0.5, 1, col = "green")
abline(-0.6, 0.95, col = "orange")
plot(x1, x2, col = c("blue", "red")[y], pch = 20)
abline(-0.5, 1)
abline(-0.6, 0.95, col = "orange")
plot(x1, x2, col = c("blue", "red")[y], pch = 20)
abline(-0.5, 1)
abline(-0.4, 0.95, col = "orange")
plot(x1, x2, col = c("blue", "red")[y], pch = 20)
abline(-0.5, 1)
abline(-0.45, 0.95, col = "orange")
plot(x1, x2, col = c("blue", "red")[y], pch = 20)
abline(-0.5, 1)
abline(-0.55, 0.95, col = "orange")
plot(x1, x2, col = c("blue", "red")[y], pch = 20)
abline(-0.5, 1)
abline(-0.55, 0.95, col = "orange")
x1 <- c(3, 2, 4, 1, 2, 4, 4, 2)
x2 <- c(4, 2, 4, 4, 1, 3, 1, 3.5)
y <- c("Red", "Red", "Red", "Red", "Blue", "Blue", "Blue", "Blue")
y <- as.factor(y)
newdata <- data.frame(x1, x2, y)
plot(x1, x2, col = c("blue", "red")[y], pch = 20)
x1 <- c(3, 2, 4, 1, 2, 4, 4, 2.5)
x2 <- c(4, 2, 4, 4, 1, 3, 1, 3.5)
y <- c("Red", "Red", "Red", "Red", "Blue", "Blue", "Blue", "Blue")
y <- as.factor(y)
newdata <- data.frame(x1, x2, y)
plot(x1, x2, col = c("blue", "red")[y], pch = 20)
#To install Rule Fit
platform = "windows"
rfhome = "C:/Program Files/R/RFHOME"
source("C:/Program Files/R/RFHOME/rulefit.r")
install.packages("akima", lib=rfhome)
library(akima, lib.loc=rfhome)
#end of rulefit install
library(gdata)
diamondData<-read.xls("Diamond_Data.xls", perl = "c:/Perl64/bin/perl.exe")
setwd("D:/Courses/Pattern Recognition/assignments/HW4/data/Diamond_data")
library(gdata)
diamondData<-read.xls("Diamond_Data.xls", perl = "c:/Perl64/bin/perl.exe")
cat.var <- c("Cut", "Color", "Clarity","Polish","Symmetry","Report")
per <- floor(nrow(diamondData)*5/6)
subs <- sample(nrow(diamondData),per)
train <- diamondData[subs,]
x <- train[,2:8]
y <- train[,9]
x<- train[,2:9]
X1<-as(x,"data.frame")
X2<-as(X1,"data.frame")
install.packages("tree")
library(tree)
dtr<-tree(Price~.,X1)
plot(dtr)
text(dtr, cex=.8,pretty=0)
install.packages("rpart")
library(rpart)
ftO<-rpart(Price ~ .,data=X2,method="class",cp=0.0001)
plotcp(ftO)
printcp(ftO)
fto.cpt<-ftO$cptable
min(fto.cpt[,"xerror"])
row_min<-which(fto.cpt[,"xerror"]==min(fto.cpt[,"xerror"]))
fto.cpt[row_min,"CP"]
fto.cpt[row_min,"CP"]
best_cp<-fto.cpt[row_min,"CP"]
best_cp[1]
dtree_new<-prune(ftO, best_cp[1])
dtree<-prune(ftO, best_cp[1])
summary(dtree)
dtree<-prune(ftO, best_cp[1])
plot(dtree,uniform=T)
text(dtree,use.n=F,digits=3,cex=0.4,pretty=0)
min(fto.cpt[,"xerror"])
